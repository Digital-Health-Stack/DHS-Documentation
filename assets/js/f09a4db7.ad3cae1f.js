"use strict";(self.webpackChunkdhs_docs=self.webpackChunkdhs_docs||[]).push([[370],{8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>t});var r=s(6540);const i={},d=r.createContext(i);function l(e){const n=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(d.Provider,{value:n},e.children)}},9164:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>x,frontMatter:()=>l,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"aws-setup/guide","title":"AWS Testing Setup Details","description":"---","source":"@site/docs/aws-setup/guide.md","sourceDirName":"aws-setup","slug":"/aws-setup/guide","permalink":"/DHS-Documentation/docs/aws-setup/guide","draft":false,"unlisted":false,"editUrl":"https://github.com/Digital-Health-Stack/DHS-Documentation.git/edit/main/docs/aws-setup/guide.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"AWS Setup Introduction","permalink":"/DHS-Documentation/docs/aws-setup/intro"},"next":{"title":"Prerequisite Guide","permalink":"/DHS-Documentation/docs/setups/prerequisites"}}');var i=s(4848),d=s(8453);const l={},t="AWS Testing Setup Details",c={},h=[{value:"1. AWS IAM User Setup",id:"1-aws-iam-user-setup",level:2},{value:"2. Launching EC2 Instances",id:"2-launching-ec2-instances",level:2},{value:"2.1 Instance Specification &amp; Pricing",id:"21-instance-specification--pricing",level:3},{value:"3. S3 Folder for Intermediate Test Data",id:"3-s3-folder-for-intermediate-test-data",level:2},{value:"4. Example Cost Estimates",id:"4-example-cost-estimates",level:2}];function o(e){const n={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"aws-testing-setup-details",children:"AWS Testing Setup Details"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"1-aws-iam-user-setup",children:"1. AWS IAM User Setup"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Go to the ",(0,i.jsx)(n.strong,{children:"IAM Console"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"Users"})," \u2192 ",(0,i.jsx)(n.strong,{children:"Add users"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Enter a name (e.g., ",(0,i.jsx)(n.code,{children:"FedServer"})," or ",(0,i.jsx)(n.code,{children:"FedClient"}),")"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Select ",(0,i.jsx)(n.strong,{children:"Access key \u2013 Programmatic access"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"Next: Permissions"})," \u2192 ",(0,i.jsx)(n.strong,{children:"Attach policies directly"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Attach the following AWS\u2011managed policies:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"AmazonEC2FullAccess"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"AmazonS3FullAccess"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"IAMUserChangePassword"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Review and ",(0,i.jsx)(n.strong,{children:"Create user"}),", then securely save the ",(0,i.jsx)(n.strong,{children:"Access key ID"})," and ",(0,i.jsx)(n.strong,{children:"Secret access key"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"2-launching-ec2-instances",children:"2. Launching EC2 Instances"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Click"})," ",(0,i.jsx)(n.strong,{children:"Launch instance"})," in the EC2 console."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Configure:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Name:"})," e.g., ",(0,i.jsx)(n.code,{children:"FedServer"})," or ",(0,i.jsx)(n.code,{children:"FedClient-1"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Amazon Machine Image (AMI):"})," Ubuntu 22.04 LTS (or our custom AMI later)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Instance type:"})," choose based on your test workload (e.g., ",(0,i.jsx)(n.code,{children:"g4dn.2xlarge"})," for medium datasets). Refer to the table below for additional options."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Key pair:"})," create new or choose existing (also download the ",(0,i.jsx)(n.code,{children:".pem"})," key file!)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Storage (EBS):"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Volume type: ",(0,i.jsx)(n.code,{children:"gp3"})]}),"\n",(0,i.jsxs)(n.li,{children:["Size: ",(0,i.jsx)(n.strong,{children:"50\u2013100\u202fGB"})," (ensure usage stays below 90%)"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Networking & Security Group:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Allow ",(0,i.jsx)(n.strong,{children:"SSH (22)"})," from your IP (or from anywhere)"]}),"\n",(0,i.jsxs)(n.li,{children:["Allow port ",(0,i.jsx)(n.strong,{children:"5174"})," and ",(0,i.jsx)(n.strong,{children:"9090"})," for ",(0,i.jsx)(n.strong,{children:"FedClient"}),", or port ",(0,i.jsx)(n.strong,{children:"5173"})," and ",(0,i.jsx)(n.strong,{children:"8000"})," for ",(0,i.jsx)(n.strong,{children:"FedServer"})," from your IP (or from anywhere)"]}),"\n",(0,i.jsxs)(n.li,{children:["Allow port ",(0,i.jsx)(n.strong,{children:"80"})," and ",(0,i.jsx)(n.strong,{children:"443"})," for ",(0,i.jsx)(n.strong,{children:"HTTP"})," and ",(0,i.jsx)(n.strong,{children:"HTTPS"})," from your IP (or from anywhere)"]}),"\n",(0,i.jsxs)(n.li,{children:["Allow port ",(0,i.jsx)(n.strong,{children:"9864"})," and ",(0,i.jsx)(n.strong,{children:"9870"})," for uploading the dataset file"]}),"\n",(0,i.jsx)(n.li,{children:"Allow any additional ports for Hadoop/Spark Web UIs if needed"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Launch"})," the instance."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Instance Sizing Note:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"FedServer:"})," scale up if coordinating many clients"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"FedClient:"})," scale up for larger local preprocessing or model training"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"21-instance-specification--pricing",children:"2.1 Instance Specification & Pricing"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Instance Type"}),(0,i.jsx)(n.th,{children:"GPUs"}),(0,i.jsx)(n.th,{children:"vCPUs"}),(0,i.jsx)(n.th,{children:"RAM (GiB)"}),(0,i.jsx)(n.th,{children:"GPU RAM (GiB)"}),(0,i.jsx)(n.th,{children:"Instance Storage"}),(0,i.jsx)(n.th,{children:"Net Perf (Gbps)"}),(0,i.jsx)(n.th,{children:"EBS Bandwidth (Gbps)"}),(0,i.jsx)(n.th,{children:"On\u2011Demand Price (USD/hr)"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"g4dn.2xlarge"})}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"8"}),(0,i.jsx)(n.td,{children:"32"}),(0,i.jsx)(n.td,{children:"16"}),(0,i.jsx)(n.td,{children:"1\xd7225\u202fGB NVMe SSD"}),(0,i.jsx)(n.td,{children:"Up to 25"}),(0,i.jsx)(n.td,{children:"Up to 3.5"}),(0,i.jsx)(n.td,{children:"0.75"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"g4dn.4xlarge"})}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"16"}),(0,i.jsx)(n.td,{children:"64"}),(0,i.jsx)(n.td,{children:"16"}),(0,i.jsx)(n.td,{children:"1\xd7225\u202fGB NVMe SSD"}),(0,i.jsx)(n.td,{children:"Up to 25"}),(0,i.jsx)(n.td,{children:"4.75"}),(0,i.jsx)(n.td,{children:"1.20"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"g4dn.8xlarge"})}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"32"}),(0,i.jsx)(n.td,{children:"128"}),(0,i.jsx)(n.td,{children:"16"}),(0,i.jsx)(n.td,{children:"1\xd7900\u202fGB NVMe SSD"}),(0,i.jsx)(n.td,{children:"50"}),(0,i.jsx)(n.td,{children:"4.75"}),(0,i.jsx)(n.td,{children:"2.40"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"g4dn.12xlarge"})}),(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:"48"}),(0,i.jsx)(n.td,{children:"192"}),(0,i.jsx)(n.td,{children:"64"}),(0,i.jsx)(n.td,{children:"1\xd7900\u202fGB NVMe SSD"}),(0,i.jsx)(n.td,{children:"50"}),(0,i.jsx)(n.td,{children:"9.5"}),(0,i.jsx)(n.td,{children:"3.63"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"g4dn.16xlarge"})}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"64"}),(0,i.jsx)(n.td,{children:"256"}),(0,i.jsx)(n.td,{children:"16"}),(0,i.jsx)(n.td,{children:"1\xd7900\u202fGB NVMe SSD"}),(0,i.jsx)(n.td,{children:"50"}),(0,i.jsx)(n.td,{children:"9.5"}),(0,i.jsx)(n.td,{children:"4.82"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"g4dn.metal"})}),(0,i.jsx)(n.td,{children:"8"}),(0,i.jsx)(n.td,{children:"96"}),(0,i.jsx)(n.td,{children:"384"}),(0,i.jsx)(n.td,{children:"128"}),(0,i.jsx)(n.td,{children:"2\xd7900\u202fGB NVMe SSD"}),(0,i.jsx)(n.td,{children:"100"}),(0,i.jsx)(n.td,{children:"19"}),(0,i.jsx)(n.td,{children:"5.42"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"3-s3-folder-for-intermediate-test-data",children:"3. S3 Folder for Intermediate Test Data"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Create a Bucket"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.strong,{children:"S3"})," \u2192 ",(0,i.jsx)(n.strong,{children:"Create bucket"})]}),"\n",(0,i.jsxs)(n.li,{children:["Name: ",(0,i.jsx)(n.code,{children:"fed-learning-test-bucket"})]}),"\n",(0,i.jsx)(n.li,{children:"Region: same as EC2 instances"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:'Create a "folder"'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Inside the bucket, click ",(0,i.jsx)(n.strong,{children:"Create folder"})]}),"\n",(0,i.jsxs)(n.li,{children:["Name it: ",(0,i.jsx)(n.code,{children:"client-uploads/"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Lock Down Permissions"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Attach the following ",(0,i.jsx)(n.strong,{children:"bucket policy"})," (replace ",(0,i.jsx)(n.code,{children:"<ACCOUNT_ID>"})," and ",(0,i.jsx)(n.code,{children:"<BUCKET_NAME>"}),"):","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "Version": "2012-10-17",\r\n  "Statement": [\r\n    {\r\n      "Sid": "ServerFullAccess",\r\n      "Effect": "Allow",\r\n      "Principal": { "AWS": "arn:aws:iam::<ACCOUNT_ID>:user/FedServer" },\r\n      "Action": [\r\n        "s3:GetObject",\r\n        "s3:PutObject",\r\n        "s3:DeleteObject",\r\n        "s3:ListBucket"\r\n      ],\r\n      "Resource": [\r\n        "arn:aws:s3:::<BUCKET_NAME>/*",\r\n        "arn:aws:s3:::<BUCKET_NAME>"\r\n      ]\r\n    },\r\n    {\r\n      "Sid": "ClientsWriteOnly",\r\n      "Effect": "Allow",\r\n      "Principal": { "AWS": "arn:aws:iam::<ACCOUNT_ID>:user/FedClient*" },\r\n      "Action": ["s3:PutObject"],\r\n      "Resource": "arn:aws:s3:::<BUCKET_NAME>/client-uploads/*"\r\n    }\r\n  ]\r\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["This ensures:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"FedServer"})," user can ",(0,i.jsx)(n.strong,{children:"list"}),", ",(0,i.jsx)(n.strong,{children:"read"}),", ",(0,i.jsx)(n.strong,{children:"write"}),", and ",(0,i.jsx)(n.strong,{children:"delete"})," anywhere in the bucket"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"FedClient"})," users can ",(0,i.jsx)(n.strong,{children:"only write"})," into ",(0,i.jsx)(n.code,{children:"client-uploads/"}),"; no read or delete"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Env File Reminder:"}),(0,i.jsx)(n.br,{}),"\n","Later, you will need to reference this bucket and folder name in the environment files of both your clients and server."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"4-example-cost-estimates",children:"4. Example Cost Estimates"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Scenario"}),(0,i.jsx)(n.th,{children:"Instance Type"}),(0,i.jsx)(n.th,{children:"# Instances"}),(0,i.jsx)(n.th,{children:"Cost per Hour (USD)"}),(0,i.jsx)(n.th,{children:"Cost per Day (USD)"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1\u202fServer + 3\u202fClients"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"g4dn.2xlarge"})}),(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:"4\u202f\xd7\u202f0.75\u202f=\u202f3.00"}),(0,i.jsx)(n.td,{children:"3.00\u202f\xd7\u202f24\u202f=\u202f72.00"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1\u202fServer + 5\u202fClients"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"g4dn.2xlarge"})}),(0,i.jsx)(n.td,{children:"6"}),(0,i.jsx)(n.td,{children:"6\u202f\xd7\u202f0.75\u202f=\u202f4.50"}),(0,i.jsx)(n.td,{children:"4.50\u202f\xd7\u202f24\u202f=\u202f108.00"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1\u202fServer + 3\u202fClients"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"g4dn.4xlarge"})}),(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:"4\u202f\xd7\u202f1.20\u202f=\u202f4.80"}),(0,i.jsx)(n.td,{children:"4.80\u202f\xd7\u202f24\u202f=\u202f115.20"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1\u202fServer + 5\u202fClients"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"g4dn.4xlarge"})}),(0,i.jsx)(n.td,{children:"6"}),(0,i.jsx)(n.td,{children:"6\u202f\xd7\u202f1.20\u202f=\u202f7.20"}),(0,i.jsx)(n.td,{children:"7.20\u202f\xd7\u202f24\u202f=\u202f172.80"})]})]})]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note:"}),(0,i.jsx)(n.br,{}),"\n","Instance costs may vary over time. Please refer to the official AWS pricing page for the most up-to-date pricing information."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Next Steps:"}),' Detailed "### Inside the EC2 Instance" instructions (installing pseudo\u2011distributed Hadoop/Spark, environment variables, mounting S3 via ',(0,i.jsx)(n.code,{children:"s3a://"}),", etc.) are in the ",(0,i.jsx)(n.strong,{children:"setup.md"})," file."]}),"\n"]})]})}function x(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);